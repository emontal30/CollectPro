<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1024" />
  <title>ููุญุฉ ุงูุชุญูู - CollectPro</title>
  <meta name="theme-color" content="#ffffff"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="sidebar.css" />
  <link rel="stylesheet" href="admin.css" />
</head>
<body class="loaded">
  <!-- ุญุงููุฉ ุงูุชูุจููุงุช -->
  <div id="alert-container" class="alert-container"></div>

  <!-- ุฑุณุงูุฉ ุชุซุจูุช ุงูุชุทุจูู -->
  <div id="install-prompt" class="install-prompt">
    <div class="install-prompt-content">
      <div class="install-icon">
        <img src="web-app-manifest-192x192.png" alt="ุฃููููุฉ ุงูุชุทุจูู" />
      </div>
      <div class="install-text">
        <h3>ุซุจูุช ุชุทุจูู Collect Pro</h3>
        <p>ุงุญุตู ุนูู ุชุฌุฑุจุฉ ุงุณุชุฎุฏุงู ุฃูุถู ูุฃุณุฑุน! ุซุจูุช ุงูุชุทุจูู ุนูู ูุงุชูู ูููุตูู ุงูููุฑู ูููุฒุงุช ุญุตุฑูุฉ.</p>
      </div>
      <div class="install-buttons">
        <button id="install-btn" class="install-btn">ุชุซุจูุช</button>
        <button id="dismiss-btn" class="dismiss-btn">ูุงุญูุงู</button>
      </div>
    </div>
  </div>

  <!-- ๐ ุงูุดุฑูุท ุงูุนููู -->
  <div class="topbar">
    <div class="actions">
      <button class="toggle-btn" id="toggle-btn"><i class="fa-solid fa-bars"></i></button>
    </div>
    <div class="logo">
        <img src="logo-momkn.png" alt="ุดุนุงุฑ ูููู" class="logo-img" />
        <p class="app-name">CollectPro</p>
    </div>
  </div>

  <!-- ุงูุฎูููุฉ ุงูุดูุงูุฉ ููุดุฑูุท ุงูุฌุงูุจู -->
  <div class="overlay" id="overlay"></div>

  <!-- ๐จ ุงูุดุฑูุท ุงูุฌุงูุจู -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="user-box">
          <div class="user-meta">
            <span class="user-name" id="user-name">ุงุณู ุงููุณุชุฎุฏู</span>
            <span class="user-email" id="user-email">user@example.com</span>
            <span class="user-id" id="user-id"></span>
          </div>
        </div>
      </div>
      <div class="sidebar-content">
        <ul class="nav-links">
          <li><a href="dashboard.html"><i class="fas fa-tachometer-alt"></i><span>ุฅุฏุฎุงู ุงูุจูุงูุงุช</span></a></li>
          <li><a href="harvest.html"><i class="fas fa-donate"></i><span>ุงูุชุญุตููุงุช</span></a></li>
          <li><a href="archive.html"><i class="fas fa-archive"></i><span>ุงูุฃุฑุดูู</span></a></li>
          <li><a href="counter.html"><i class="fas fa-calculator"></i><span>ุนุฏุงุฏ ุงูุฃููุงู</span></a></li>
          <li><a href="subscriptions.html"><i class="fas fa-credit-card"></i><span>ุงูุงุดุชุฑุงูุงุช</span></a></li>
          <li><a href="my-subscription.html"><i class="fas fa-user-shield"></i><span>ุงุดุชุฑุงูู</span></a></li>
          <li id="admin-link"><a href="admin.html"><i class="fas fa-user-cog"></i><span>ููุญุฉ ุงูุชุญูู</span></a></li>
        </ul>
      </div>
      <div class="sidebar-footer">
          <div class="subscription-info" id="subscription-info">
            <div class="subscription-days-simple">
              <i class="fas fa-clock"></i>
              <span id="days-left">-</span>
              <span> ููู ูุชุจูู</span>
            </div>
          </div>
          <button id="logout-btn" class="logout-btn">
              <i class="fas fa-sign-out-alt"></i>
              <span>ุชุณุฌูู ุงูุฎุฑูุฌ</span>
          </button>
      </div>
  </div>

  <!-- ุฎูููุฉ ุดูุงูุฉ -->
  <div class="overlay" id="overlay"></div>

  <header>
    <button id="toggleDark" title="ุชุจุฏูู ุงููุถุน ุงููููู">
      <i class="fas fa-moon"></i>
    </button>
    <div class="header-content">
      <div class="zoom-controls">
        <button class="zoom-out-btn" id="zoom-out-btn" title="ุชุตุบูุฑ ุงููุต">
          <i class="fas fa-search-minus"></i>
        </button>
        <button class="zoom-in-btn" id="zoom-in-btn" title="ุชูุจูุฑ ุงููุต">
          <i class="fas fa-search-plus"></i>
        </button>
      </div>
      <h1><i class="fas fa-cog"></i> ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ</h1>
      <div style="width: 100px;"></div>
    </div>
  </header>

  <main>
    <div class="admin-dashboard">
      <div class="stats-container">
         <div class="stat-card">
           <div class="stat-icon"><i class="fas fa-users"></i></div>
           <div class="stat-content">
             <h3>ุฅุฌูุงูู ุงููุณุชุฎุฏููู</h3>
             <p class="stat-value" id="total-users">0</p>
             <div class="stat-trend positive">
               <i class="fas fa-arrow-up"></i>
               <span>ูุณุชุฎุฏู ูุดุท</span>
             </div>
           </div>
         </div>
         <div class="stat-card">
           <div class="stat-icon"><i class="fas fa-user-check"></i></div>
           <div class="stat-content">
             <h3 id="active-users-title">ูุณุชุฎุฏููู ูุนูุงููู</h3>
             <p class="stat-value" id="active-users-30">0</p>
             <div class="stat-trend positive">
               <i class="fas fa-user-clock"></i>
               <span>ูุดุทูู ูุคุฎุฑูุง</span>
             </div>
             <div class="stat-filters">
               <select id="active-users-period" class="stat-filter-select">
                 <option value="1">ุขุฎุฑ ููู</option>
                 <option value="7">ุขุฎุฑ 7 ุฃูุงู</option>
                 <option value="30" selected>ุขุฎุฑ 30 ููู</option>
               </select>
             </div>
           </div>
         </div>
         <div class="stat-card">
           <div class="stat-icon"><i class="fas fa-clock"></i></div>
           <div class="stat-content">
             <h3>ุทูุจุงุช ููุฏ ุงููุฑุงุฌุนุฉ</h3>
             <p class="stat-value" id="pending-requests">0</p>
             <div class="stat-trend neutral">
               <i class="fas fa-clock"></i>
               <span>ุชุญุชุงุฌ ูุฑุงุฌุนุฉ</span>
             </div>
           </div>
         </div>
         <div class="stat-card">
           <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
           <div class="stat-content">
             <h3>ุงุดุชุฑุงูุงุช ูุดุทุฉ</h3>
             <p class="stat-value" id="active-subscriptions">0</p>
             <div class="stat-trend positive">
               <i class="fas fa-arrow-up"></i>
               <span>ูุดุท ุงูุขู</span>
             </div>
           </div>
         </div>
         <div class="stat-card">
           <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
           <div class="stat-content">
             <h3>ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช</h3>
             <p class="stat-value" id="total-revenue">0 ุฌ.ู</p>
             <div class="stat-trend positive">
               <i class="fas fa-chart-line"></i>
               <span>ูู ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ</span>
             </div>
           </div>
         </div>
       </div>

      <!-- ูุฎุทุท ุชูุงุนูู ููุฅุญุตุงุฆูุงุช -->
      <div class="admin-section">
        <div class="section-header">
          <h2><i class="fas fa-chart-bar"></i> ุชุญููู ุงูุฅุญุตุงุฆูุงุช ุงูุชูุงุนูู</h2>
          <div class="chart-controls">
            <button class="chart-toggle active" data-chart="bars">
              <i class="fas fa-chart-bar"></i>
              <span>ุฃุนูุฏุฉ</span>
            </button>
            <button class="chart-toggle" data-chart="pie">
              <i class="fas fa-chart-pie"></i>
              <span>ุฏุงุฆุฑู</span>
            </button>
            <button class="chart-toggle" data-chart="line">
              <i class="fas fa-chart-line"></i>
              <span>ุฎุทู</span>
            </button>
          </div>
        </div>
        <div class="chart-container">
          <div class="simple-chart active" id="bars-chart">
            <div class="chart-bar" data-value="0" data-label="ุงูุฑุถุง ุงูุนุงู">
              <div class="bar-fill" style="height: 0%"></div>
              <span class="bar-label">0%</span>
            </div>
            <div class="chart-bar" data-value="0" data-label="ูุนุฏู ุงููุฌุงุญ">
              <div class="bar-fill" style="height: 0%"></div>
              <span class="bar-label">0%</span>
            </div>
            <div class="chart-bar" data-value="0" data-label="ุงูููู ุงูุดูุฑู">
              <div class="bar-fill" style="height: 0%"></div>
              <span class="bar-label">0%</span>
            </div>
            <div class="chart-bar" data-value="0" data-label="ุงูุฃุฏุงุก">
              <div class="bar-fill" style="height: 0%"></div>
              <span class="bar-label">0%</span>
            </div>
          </div>

          <div class="pie-chart" id="pie-chart">
            <div class="pie-container">
              <div class="pie-segment" style="--percentage: 0; --color: #007965;"></div>
              <div class="pie-segment" style="--percentage: 0; --color: #00a085;"></div>
              <div class="pie-segment" style="--percentage: 0; --color: #28a745;"></div>
              <div class="pie-segment" style="--percentage: 0; --color: #f39c12;"></div>
            </div>
            <div class="pie-legend">
              <div class="legend-item">
                <span class="legend-color" style="background: #007965;"></span>
                <span>ูุดุท (0%)</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background: #00a085;"></span>
                <span>ูุนูู (0%)</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background: #28a745;"></span>
                <span>ููุบู (0%)</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background: #f39c12;"></span>
                <span>ููุชูู (0%)</span>
              </div>
            </div>
          </div>

          <div class="line-chart" id="line-chart">
            <svg class="line-svg" viewBox="0 0 400 200">
              <polyline class="line-path" points="50,180 125,180 200,180 275,180 350,180"/>
              <circle class="line-point" cx="50" cy="180" r="4"/>
              <circle class="line-point" cx="125" cy="180" r="4"/>
              <circle class="line-point" cx="200" cy="180" r="4"/>
              <circle class="line-point" cx="275" cy="180" r="4"/>
              <circle class="line-point" cx="350" cy="180" r="4"/>
            </svg>
            <div class="line-labels">
              <span>ููุงูุฑ</span>
              <span>ูุจุฑุงูุฑ</span>
              <span>ูุงุฑุณ</span>
              <span>ุฃุจุฑูู</span>
              <span>ูุงูู</span>
            </div>
          </div>
        </div>
        <div class="chart-info">
          <div class="info-item">
            <i class="fas fa-info-circle"></i>
            <span>ุงูุจูุงูุงุช ุชูุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ุชุญููู ุงูุตูุญุฉ</span>
          </div>
          <div class="info-item">
            <i class="fas fa-sync-alt"></i>
            <span>ุงุถุบุท ุนูู ุฒุฑ "ุชุญุฏูุซ" ููุญุตูู ุนูู ุฃุญุฏุซ ุงูุจูุงูุงุช</span>
          </div>
          <div class="info-item">
            <i class="fas fa-chart-pie"></i>
            <span id="advanced-stats-summary">ุณูุชู ุชุญููู ุงูุฅุญุตุงุฆูุงุช ุงููุชูุฏูุฉ...</span>
          </div>
        </div>
      </div>
      <div class="admin-section">
        <div class="section-header">
          <div class="section-title-with-refresh">
            <h2><i class="fas fa-users-cog"></i> ุงููุณุชุฎุฏููู ุงููุณุฌููู</h2>
            <div class="table-stats users-header-stats">
              <span id="logged-in-users-count">0</span> ูุณุชุฎุฏู ูุณุฌู
            </div>
            <button id="refresh-users-btn" class="btn-secondary small-refresh-btn">
              <i class="fas fa-sync-alt"></i>
            </button>
          </div>
          <p class="section-subtitle users-subtitle">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ุงูุฐูู ูุงููุง ุจุชุณุฌูู ุงูุฏุฎูู ูุชูุนูู ุงูุงุดุชุฑุงูุงุช ููู</p>
        </div>
        <div class="table-header-info">
          <div class="table-actions users-search">
            <input type="text" id="logged-in-users-search" class="filter-select users-search-input" placeholder="ุงุจุญุซ ุจุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" />
          </div>
          <div class="table-actions users-bulk-actions">
            <input type="number" id="bulk-users-days-input" class="subscription-days-input" min="1" placeholder="ุงุฏุฎู ุงููุชุฑู" />
            <button id="bulk-activate-users-btn" class="btn-success">
              <i class="fas fa-check-double"></i> ุชูุนูู ุงููู / ุงููุญุฏุฏ
            </button>
          </div>
        </div>
        <div class="table-container">
          <table id="logged-in-users-table">
            <thead>
              <tr>
                <th><input type="checkbox" id="select-all-logged-users" class="select-all-checkbox" title="ุชุญุฏูุฏ ูู ุงููุณุชุฎุฏููู" /></th>
                <th><i class="fas fa-id-badge"></i> ูุนุฑู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-user"></i> ุงุณู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-envelope"></i> ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                <th><i class="fas fa-calendar-alt"></i> ุชุงุฑูุฎ ุงูุฅูุดุงุก</th>
                <th class="col-subscription"><i class="fas fa-clock"></i> ูุฏุฉ ุงูุงุดุชุฑุงู (ุฃูุงู)</th>
                <th><i class="fas fa-cogs"></i> ุงูุฅุฌุฑุงุกุงุช</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div id="no-logged-in-users" class="no-data">
            <i class="fas fa-inbox"></i>
            <p>ูุง ููุฌุฏ ูุณุชุฎุฏููู ูุณุฌููู ุญุชู ุงูุขู</p>
            <small>ุณูุธูุฑ ููุง ูู ูู ูุงู ุจุชุณุฌูู ุฏุฎูู ูุงุฌุญ</small>
          </div>
        </div>
      </div>
      <div class="admin-section">
        <div class="section-header">
          <h2><i class="fas fa-clock"></i> ุทูุจุงุช ุงูุงุดุชุฑุงู ููุฏ ุงููุฑุงุฌุนุฉ</h2>
          <div class="section-actions">
            <button id="activate-all-btn" class="btn-success">
              <i class="fas fa-check-double"></i>ุชูุนูู ุงููู
            </button>
            <button id="cancel-all-btn" class="btn-danger">
              <i class="fas fa-times-circle"></i>ุฅูุบุงุก ุงููู
            </button>
          </div>
        </div>
        <div class="table-header-info">
          <div class="table-info">
            <i class="fas fa-info-circle"></i>
            <span>ููููู ุชุญุฏูุฏ ุนุฏุฉ ุทูุจุงุช ูุชูุนูููุง ุฃู ุฅูุบุงุคูุง ุฏูุนุฉ ูุงุญุฏุฉ</span>
          </div>
          <div class="table-stats">
            <span id="selected-count">0</span> ูุญุฏุฏ
          </div>
        </div>
        <div class="table-container">
           <table id="pending-subscriptions-table">
            <thead>
              <tr>
                <th><input type="checkbox" id="select-all" class="select-all-checkbox" title="ุชุญุฏูุฏ ุงููู" /></th>
                <th><i class="fas fa-id-badge"></i> ูุนุฑู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-user"></i> ุงุณู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-envelope"></i> ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                <th><i class="fas fa-crown"></i> ููุน ุงูุงุดุชุฑุงู</th>
                <th><i class="fas fa-hashtag"></i> ุฑูู ุงูุนูููุฉ</th>
                <th><i class="fas fa-calendar-alt"></i> ุชุงุฑูุฎ ุงูุทูุจ</th>
                <th><i class="fas fa-cogs"></i> ุงูุฅุฌุฑุงุกุงุช</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div id="no-pending-requests" class="no-data">
            <i class="fas fa-inbox"></i>
            <p>ูุง ุชูุฌุฏ ุทูุจุงุช ุงุดุชุฑุงู ููุฏ ุงููุฑุงุฌุนุฉ</p>
            <small>ุณุชุธูุฑ ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ ููุง ุชููุงุฆูุงู</small>
          </div>
        </div>
      </div>
      <div class="admin-section">
        <div class="section-header">
           <div class="section-title-with-refresh">
             <h2><i class="fas fa-list"></i> ุฌููุน ุงูุงุดุชุฑุงูุงุช</h2>
             <div class="table-stats subscriptions-header-stats">
               <span id="total-subscriptions-count">0</span> ุงุดุชุฑุงู ุฅุฌูุงูู
             </div>
             <button id="refresh-btn" class="btn-secondary small-refresh-btn">
               <i class="fas fa-sync-alt"></i>
             </button>
           </div>
           <p class="section-subtitle subscriptions-subtitle">ุฅุฏุงุฑุฉ ุดุงููุฉ ูุฌููุน ุงูุงุดุชุฑุงูุงุช ูู ุงููุธุงู</p>
        </div>
        <div class="table-header-info">
          <div class="filter-container">
            <div class="filter-group">
              <label for="status-filter" class="filter-label">
                <i class="fas fa-filter"></i>
                <span>ููุชุฑุฉ ุญุณุจ ุงูุญุงูุฉ</span>
              </label>
              <select id="status-filter" class="filter-select">
                <option value="all">ุฌููุน ุงูุญุงูุงุช</option>
                <option value="pending">ููุฏ ุงููุฑุงุฌุนุฉ</option>
                <option value="active">ูุดุท</option>
                <option value="cancelled">ููุบู</option>
                <option value="expired">ููุชูู</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="plan-type-filter" class="filter-label">
                <i class="fas fa-calendar-alt"></i>
                <span>ููุน ุงูุงุดุชุฑุงู</span>
              </label>
              <select id="plan-type-filter" class="filter-select">
                <option value="all">ูู ุงูุฃููุงุน</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="expiry-filter" class="filter-label">
                <i class="fas fa-exclamation-triangle"></i>
                <span>ุตูุงุญูุฉ ุงูุงุดุชุฑุงู</span>
              </label>
              <select id="expiry-filter" class="filter-select">
                <option value="all">ูู ุงูุงุดุชุฑุงูุงุช</option>
                <option value="expiring_soon">ูุฑูุจุฉ ูู ุงูุงูุชูุงุก (ุฃูู ูู 7 ุฃูุงู)</option>
              </select>
            </div>
          </div>
        </div>
        <div class="table-container">
           <table id="all-subscriptions-table">
            <thead>
              <tr>
                <th><i class="fas fa-id-badge"></i> ูุนุฑู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-user"></i> ุงุณู ุงููุณุชุฎุฏู</th>
                <th><i class="fas fa-envelope"></i> ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                <th><i class="fas fa-crown"></i> ููุน ุงูุงุดุชุฑุงู</th>
                <th><i class="fas fa-hashtag"></i> ุฑูู ุงูุนูููุฉ</th>
                <th><i class="fas fa-play-circle"></i> ุชุงุฑูุฎ ุงูุจุฏุก</th>
                <th><i class="fas fa-stop-circle"></i> ุตูุงุญูุฉ ุงูุงุดุชุฑุงู</th>
                <th><i class="fas fa-flag"></i> ุงูุญุงูุฉ</th>
                <th><i class="fas fa-cogs"></i> ุงูุฅุฌุฑุงุกุงุช</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div id="no-subscriptions" class="no-data">
            <i class="fas fa-inbox"></i>
            <p>ูุง ุชูุฌุฏ ุงุดุชุฑุงูุงุช</p>
            <small>ุณูุชู ุนุฑุถ ุงูุงุดุชุฑุงูุงุช ููุง ุนูุฏ ุฅูุดุงุฆูุง</small>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div id="alert-container" class="alert-container"></div>

  <div id="subscription-details-modal" class="modal"><div class="modal-content"><div class="modal-header"><h2>ุชูุงุตูู ุงูุงุดุชุฑุงู</h2><button class="close-modal">&times;</button></div><div class="modal-body"><div class="details-container"><div class="detail-item"><span class="detail-label">ูุนุฑู ุงููุณุชุฎุฏู:</span><span class="detail-value" id="detail-user-id">-</span></div><div class="detail-item"><span class="detail-label">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</span><span class="detail-value" id="detail-email">-</span></div><div class="detail-item"><span class="detail-label">ููุน ุงูุงุดุชุฑุงู:</span><span class="detail-value" id="detail-plan">-</span></div><div class="detail-item"><span class="detail-label">ุฑูู ุงูุนูููุฉ:</span><span class="detail-value" id="detail-transaction-id">-</span></div><div class="detail-item"><span class="detail-label">ุชุงุฑูุฎ ุงูุทูุจ:</span><span class="detail-value" id="detail-created-at">-</span></div><div class="detail-item"><span class="detail-label">ุชุงุฑูุฎ ุงูุจุฏุก:</span><span class="detail-value" id="detail-start-date">-</span></div><div class="detail-item"><span class="detail-label">ุชุงุฑูุฎ ุงูุงูุชูุงุก:</span><span class="detail-value" id="detail-end-date">-</span></div><div class="detail-item"><span class="detail-label">ุงูุญุงูุฉ:</span><span class="detail-value" id="detail-status">-</span></div></div></div><div class="modal-footer"><button id="close-details-btn" class="btn-secondary">ุฅุบูุงู</button></div></div>

  <footer id="footer" class="footer">
  <p>ยฉ <span id="year"></span> ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
  <p>ุชู ุงูุชุตููู ูุงูุชุทููุฑ ุจูุงุณุทุฉ | <strong style="color:#ff6600;">ุฃููู ุญุงูุธ</strong> v2.4.5</p>
 </footer>

  <!-- Scripts at the end for correct order and performance -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" src="/src/supabase-client.js"></script>
  <script type="module" src="/src/sidebar.js"></script>
  <script type="module" src="/src/script.js"></script>
  <script type="module" src="/src/admin.js"></script>
  <script type="module" src="/src/install-prompt.js"></script>
</body>
</html>