<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>اختبار التحسينات - CollectPro</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .test-result {
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border-right: 4px solid;
    }
    .pass { border-color: #27ae60; background: #d5f4e6; }
    .fail { border-color: #e74c3c; background: #fadbd8; }
    .warn { border-color: #f39c12; background: #fef9e7; }
    .info { border-color: #3498db; background: #d4e6f1; }
    h1 { color: #2c3e50; text-align: center; }
    h2 { color: #34495e; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
    .score { font-size: 24px; font-weight: bold; text-align: center; margin: 20px 0; }
    .excellent { color: #27ae60; }
    .good { color: #f39c12; }
    .poor { color: #e74c3c; }
  </style>
</head>
<body>
  <div class="container">
    <h1>🧪 اختبار التحسينات - CollectPro</h1>
    <div id="test-results">
      <div class="info test-result">
        <strong>جاري الاختبار...</strong> يرجى الانتظار قليلاً
      </div>
    </div>
    <div class="score" id="overall-score">-</div>
  </div>

  <script>
    // اختبار بسيط للتحسينات
    async function runQuickTests() {
      const results = [];
      let totalScore = 0;

      // اختبار 1: Service Worker
      if ('serviceWorker' in navigator) {
        try {
          const registration = await navigator.serviceWorker.getRegistration();
          results.push({
            name: 'Service Worker',
            status: registration ? 'pass' : 'warn',
            message: registration ? '✅ Service Worker مسجل بنجاح' : '⚠️ Service Worker غير مسجل'
          });
          totalScore += registration ? 20 : 10;
        } catch (error) {
          results.push({
            name: 'Service Worker',
            status: 'fail',
            message: '❌ خطأ في Service Worker: ' + error.message
          });
        }
      } else {
        results.push({
          name: 'Service Worker',
          status: 'fail',
          message: '❌ Service Worker غير مدعوم'
        });
      }

      // اختبار 2: Lazy Loading
      const hasIntersectionObserver = 'IntersectionObserver' in window;
      results.push({
        name: 'Lazy Loading',
        status: hasIntersectionObserver ? 'pass' : 'warn',
        message: hasIntersectionObserver ? '✅ IntersectionObserver مدعوم' : '⚠️ IntersectionObserver غير مدعوم'
      });
      totalScore += hasIntersectionObserver ? 15 : 8;

      // اختبار 3: Local Storage
      const hasLocalStorage = 'localStorage' in window;
      results.push({
        name: 'Local Storage',
        status: hasLocalStorage ? 'pass' : 'fail',
        message: hasLocalStorage ? '✅ Local Storage متاح' : '❌ Local Storage غير متاح'
      });
      totalScore += hasLocalStorage ? 10 : 0;

      // اختبار 4: Performance API
      const hasPerformanceAPI = 'performance' in window;
      results.push({
        name: 'Performance API',
        status: hasPerformanceAPI ? 'pass' : 'warn',
        message: hasPerformanceAPI ? '✅ Performance API متاح' : '⚠️ Performance API غير متاح'
      });
      totalScore += hasPerformanceAPI ? 10 : 5;

      // اختبار 5: Meta Tags
      const metaDescription = document.querySelector('meta[name="description"]');
      const metaKeywords = document.querySelector('meta[name="keywords"]');
      const hasMetaTags = metaDescription && metaKeywords;

      results.push({
        name: 'Meta Tags',
        status: hasMetaTags ? 'pass' : 'warn',
        message: hasMetaTags ? '✅ Meta Tags موجودة' : '⚠️ Meta Tags ناقصة'
      });
      totalScore += hasMetaTags ? 15 : 8;

      // اختبار 6: PWA
      const manifestLink = document.querySelector('link[rel="manifest"]');
      const hasPWA = manifestLink !== null;

      results.push({
        name: 'PWA Support',
        status: hasPWA ? 'pass' : 'warn',
        message: hasPWA ? '✅ PWA مدعوم' : '⚠️ PWA غير مدعوم'
      });
      totalScore += hasPWA ? 15 : 8;

      // اختبار 7: HTTPS
      const isHTTPS = window.location.protocol === 'https:';
      results.push({
        name: 'HTTPS',
        status: isHTTPS ? 'pass' : 'warn',
        message: isHTTPS ? '✅ HTTPS مفعل' : '⚠️ HTTPS غير مفعل'
      });
      totalScore += isHTTPS ? 15 : 8;

      // عرض النتائج
      displayResults(results, totalScore);
    }

    function displayResults(results, totalScore) {
      const container = document.getElementById('test-results');
      container.innerHTML = '';

      results.forEach(result => {
        const div = document.createElement('div');
        div.className = `test-result ${result.status}`;
        div.innerHTML = `<strong>${result.name}:</strong> ${result.message}`;
        container.appendChild(div);
      });

      // عرض النتيجة الإجمالية
      const scoreElement = document.getElementById('overall-score');
      let scoreClass = 'excellent';
      let scoreText = '';

      if (totalScore >= 90) {
        scoreText = `ممتاز! ${totalScore}/100`;
        scoreClass = 'excellent';
      } else if (totalScore >= 70) {
        scoreText = `جيد ${totalScore}/100`;
        scoreClass = 'good';
      } else {
        scoreText = `يحتاج تحسين ${totalScore}/100`;
        scoreClass = 'poor';
      }

      scoreElement.textContent = scoreText;
      scoreElement.className = `score ${scoreClass}`;
    }

    // تشغيل الاختبارات عند تحميل الصفحة
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(runQuickTests, 1000);
    });
  </script>
</body>
</html>